# {{ title }}

## Metadata

| Key          | Value                   |
|--------------|-------------------------|
| ID           | {{ trr_id }}            |
| External IDs | [{{ technique_id }}]    |
| Tactics      | {{ tactics | join(", ") }} |
| Platforms    | {{ platforms | join(", ") }} |
| Contributors | {{ contributors | join(", ") }} |

{% if scoping.scope_statement %}
## Scope

{{ scoping.scope_statement }}

{% if scoping.exclusions %}
**Exclusions:**

| Excluded Item | Rationale |
|---|---|
{% for ex in scoping.exclusions %}
| {{ ex.item }} | {{ ex.rationale }} |
{% endfor %}
{% endif %}
{% endif %}

## Technique Overview

{{ basic_questions.attacker_objective }}

[TODO: Expand into 2-4 accessible sentences covering what, how, and why.]

## Technical Background

[TODO: Write technical background section.]
{% if notes %}

Research notes to incorporate:
{% for note in notes %}
- {{ note.text }}
{% endfor %}
{% endif %}

## Procedures

| Procedure ID | Name | Tactic |
|---|---|---|
{% for proc in procedures %}
| {{ proc.id }} | {{ proc.name }} | {{ tactics | join(", ") }} |
{% endfor %}

{% for proc in procedures %}
### Procedure {{ proc.letter }}: {{ proc.name }}

{% if proc.narrative %}
{{ proc.narrative }}
{% else %}
[TODO: Write procedure narrative. Summary: {{ proc.summary }}
Distinguishing operations: {{ proc.distinguishing_operations }}]
{% endif %}

#### Detection Data Model

{% if proc.ddm_filename %}
![DDM - {{ proc.name }}](ddms/{{ proc.ddm_filename }})
{% else %}
[TODO: Add DDM image. Set with: proc edit {{ proc.id }} --ddm-filename "filename.png"]
{% endif %}

{% if proc.ddm_description %}
{{ proc.ddm_description }}
{% endif %}

{% endfor %}

## Available Emulation Tests

| ID | Link |
|---|---|
{% for test in emulation_tests if test.procedure_mapping %}
| {{ test.procedure_mapping }} | {% if test.github_url %}[{{ test.name }}]({{ test.github_url }}){% else %}{{ test.name }}{% endif %} |
{% endfor %}
{% if not emulation_tests %}
| | No emulation tests mapped. |
{% endif %}

## References

{% for ref in references if ref.used_in_sections %}
- [{{ ref.name }}]
{% endfor %}

{% for ref in references if ref.used_in_sections %}
[{{ ref.name }}]: {{ ref.url }}
{% endfor %}
