{
  "windows": {
    "process_creation": {
      "sources": ["Sysmon 1 (ProcessCreate)", "Win 4688 (Process Creation)", "EDR Process Telemetry", "CS ProcessRollup2"],
      "notes": "4688 requires audit policy; Sysmon captures command line by default"
    },
    "process_termination": {
      "sources": ["Sysmon 5 (ProcessTerminate)", "Win 4689 (Process Termination)", "CS EndOfProcess", "EDR Process Telemetry"]
    },
    "process_access": {
      "sources": ["Sysmon 10 (ProcessAccess)", "EDR Process Telemetry"],
      "notes": "Key for injection and credential access techniques"
    },
    "file_creation": {
      "sources": ["Sysmon 11 (FileCreate)", "Win 4663 (SACL - Object Access)", "EDR File Telemetry"],
      "notes": "4663 requires SACL on the directory"
    },
    "file_modification": {
      "sources": ["Sysmon 2 (FileCreateTime)", "Win 4663 (SACL - Object Access)", "EDR File Telemetry"]
    },
    "file_deletion": {
      "sources": ["Sysmon 23 (FileDelete - archived)", "Sysmon 26 (FileDeleteDetected)", "Win 4663 (SACL)", "EDR File Telemetry"]
    },
    "registry_create_delete": {
      "sources": ["Sysmon 12 (RegistryEvent - Create/Delete)", "Win 4657 (Registry Value Modified)", "Win 4663 (SACL)", "EDR Registry Telemetry"]
    },
    "registry_value_set": {
      "sources": ["Sysmon 13 (RegistryEvent - Value Set)", "Win 4657 (Registry Value Modified)", "CS RegSystemConfigValueUpdate"]
    },
    "registry_rename": {
      "sources": ["Sysmon 14 (RegistryEvent - Key/Value Rename)"]
    },
    "network_connection": {
      "sources": ["Sysmon 3 (NetworkConnect)", "Win 5156 (WFP Connection Permitted)", "EDR Network Telemetry"]
    },
    "dll_load": {
      "sources": ["Sysmon 7 (ImageLoaded)", "EDR Module Load Telemetry"],
      "notes": "Sysmon 7 can be noisy; filter carefully"
    },
    "dns_query": {
      "sources": ["Sysmon 22 (DNSEvent)", "Win DNS Debug Log", "EDR DNS Telemetry"]
    },
    "wmi_activity": {
      "sources": ["Sysmon 19 (WmiEventFilter)", "Sysmon 20 (WmiEventConsumer)", "Sysmon 21 (WmiEventConsumerToFilter)", "Win 5857-5861 (WMI Activity)", "CS WmiFilterConsumerBindingEtw"]
    },
    "named_pipe": {
      "sources": ["Sysmon 17 (PipeCreated)", "Sysmon 18 (PipeConnected)", "EDR Named Pipe Telemetry"]
    },
    "service_install": {
      "sources": ["Win 7045 (Service Installed)", "Win 4697 (Service Installed)", "Sysmon 6 (DriverLoaded)", "EDR Service Telemetry"]
    },
    "scheduled_task": {
      "sources": ["Win 4698 (Scheduled Task Created)", "Win 4702 (Scheduled Task Updated)", "Sysmon 1 (ProcessCreate) via schtasks.exe"]
    },
    "api_call": {
      "sources": ["ETW Provider (varies by API)", "EDR API Telemetry", "Userland hooking (EDR-specific)"],
      "notes": "API-level telemetry varies heavily by vendor and configuration"
    },
    "rpc_call": {
      "sources": ["Win 5156 (WFP Connection)", "Network capture (Wireshark/Zeek)", "EDR Network Telemetry", "ETW Microsoft-Windows-RPC"],
      "notes": "RPC often tunneled over SMB (port 445) or high dynamic ports"
    },
    "directory_service_access": {
      "sources": ["Win 4662 (Directory Service Access)", "Win 4661 (Handle to AD Object Requested)"],
      "notes": "Requires auditing enabled on the AD objects"
    },
    "authentication": {
      "sources": ["Win 4624 (Logon)", "Win 4625 (Failed Logon)", "Win 4768 (Kerberos TGT Requested)", "Win 4769 (Kerberos Service Ticket Requested)", "Win 4776 (NTLM Authentication)"]
    },
    "event_log_cleared": {
      "sources": ["Win 1102 (Security Log Cleared)", "Win 104 (System Log Cleared)"]
    }
  },
  "linux": {
    "process_creation": {
      "sources": ["auditd EXECVE", "eBPF process events", "EDR Process Telemetry", "syslog (process accounting)"]
    },
    "file_creation": {
      "sources": ["auditd CREATE/OPEN", "inotify/fanotify", "EDR File Telemetry", "AIDE/OSSEC (file integrity)"]
    },
    "file_modification": {
      "sources": ["auditd WRITE/TRUNCATE", "inotify IN_MODIFY", "EDR File Telemetry"]
    },
    "network_connection": {
      "sources": ["auditd CONNECT/BIND", "conntrack/netfilter logs", "eBPF network events", "EDR Network Telemetry"]
    },
    "authentication": {
      "sources": ["auth.log / secure log", "journald auth entries", "PAM audit events", "auditd USER_AUTH/USER_LOGIN"]
    },
    "service_management": {
      "sources": ["journald systemd events", "auditd EXECVE (systemctl)", "EDR Process Telemetry"]
    },
    "cron_job": {
      "sources": ["syslog cron entries", "auditd file access on crontab files", "inotify on /etc/cron.*"]
    }
  },
  "ad": {
    "directory_service_access": {
      "sources": ["Win 4662 (Directory Service Access)", "Win 4661 (Handle to AD Object Requested)", "Win 5136 (Directory Service Changes)", "Win 5137 (Directory Service Object Created)"],
      "notes": "Requires Directory Service Access auditing on DCs"
    },
    "replication": {
      "sources": ["Win 4662 (with replication GUIDs)", "Network capture (DRS RPC traffic)", "Microsoft Defender for Identity"]
    },
    "kerberos": {
      "sources": ["Win 4768 (TGT Request)", "Win 4769 (Service Ticket Request)", "Win 4771 (Kerberos Pre-Auth Failed)", "Win 4773 (Kerberos Service Ticket Failed)"]
    },
    "group_policy": {
      "sources": ["Win 5136 (Directory Service Changes)", "Win 4739 (Domain Policy Changed)"]
    },
    "account_management": {
      "sources": ["Win 4720 (User Account Created)", "Win 4722-4726 (Account Enabled/Changed/Deleted)", "Win 4738 (User Account Changed)", "Win 4732 (Member Added to Security Group)"]
    }
  },
  "azure": {
    "api_call": {
      "sources": ["Azure Activity Log", "Entra ID Audit Log", "Azure Monitor", "Microsoft Defender for Cloud"]
    },
    "authentication": {
      "sources": ["Entra ID Sign-in Log", "Conditional Access Log", "Azure AD Identity Protection"]
    },
    "resource_modification": {
      "sources": ["Azure Activity Log", "Azure Resource Manager Logs", "Azure Policy Compliance"]
    },
    "role_assignment": {
      "sources": ["Entra ID Audit Log", "Azure Activity Log (IAM operations)", "PIM Audit Log"]
    },
    "application_management": {
      "sources": ["Entra ID Audit Log (Application category)", "Microsoft Graph Activity Logs"]
    }
  },
  "aws": {
    "api_call": {
      "sources": ["CloudTrail", "CloudWatch Logs"]
    },
    "authentication": {
      "sources": ["CloudTrail (ConsoleLogin, AssumeRole)", "IAM Access Analyzer"]
    },
    "resource_modification": {
      "sources": ["CloudTrail", "AWS Config", "GuardDuty"]
    }
  }
}
