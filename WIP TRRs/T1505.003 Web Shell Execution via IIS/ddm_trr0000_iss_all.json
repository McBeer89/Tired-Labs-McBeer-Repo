{
  "style": {
    "font-family": "sans-serif",
    "background-color": "#ffffff",
    "background-image": "",
    "background-size": "100%",
    "node-color": "#ffffff",
    "border-width": 4,
    "border-color": "#000000",
    "radius": 50,
    "node-padding": 5,
    "node-margin": 2,
    "outside-position": "auto",
    "node-icon-image": "",
    "node-background-image": "",
    "icon-position": "inside",
    "icon-size": 64,
    "caption-position": "inside",
    "caption-max-width": 200,
    "caption-color": "#000000",
    "caption-font-size": 50,
    "caption-font-weight": "normal",
    "label-position": "inside",
    "label-display": "pill",
    "label-color": "#000000",
    "label-background-color": "#ffffff",
    "label-border-color": "#000000",
    "label-border-width": 4,
    "label-font-size": 40,
    "label-padding": 5,
    "label-margin": 4,
    "directionality": "directed",
    "detail-position": "inline",
    "detail-orientation": "parallel",
    "arrow-width": 5,
    "arrow-color": "#000000",
    "margin-start": 5,
    "margin-end": 5,
    "margin-peer": 20,
    "attachment-start": "normal",
    "attachment-end": "normal",
    "relationship-icon-image": "",
    "type-color": "#000000",
    "type-background-color": "#ffffff",
    "type-border-color": "#000000",
    "type-border-width": 0,
    "type-font-size": 16,
    "type-padding": 5,
    "property-position": "outside",
    "property-alignment": "colon",
    "property-color": "#000000",
    "property-font-size": 16,
    "property-font-weight": "normal"
  },
  "nodes": [
    {
      "id": "n0",
      "position": {
        "x": 1370.124887773176,
        "y": -91.00000000000193
      },
      "caption": "Execute Code",
      "labels": [
        "ASP.NET Compilation Artifacts"
      ],
      "properties": {},
      "style": {
        "border-color": "#0062b1",
        "label-position": "outside",
        "label-font-size": 12,
        "property-font-size": 12
      }
    },
    {
      "id": "n4",
      "position": {
        "x": 1788.3980435941858,
        "y": -308.4552397323787
      },
      "caption": "Process Spawn",
      "labels": [
        "Telemetry: Sysmon 1",
        "Telemetry: Event 4688"
      ],
      "properties": {
        "Parent Process": "w3wp.exe",
        "API": "System.Diagnostics.Process.Start() or CreateProcess (native)"
      },
      "style": {
        "caption-color": "#000000",
        "border-color": "#0062b1",
        "label-position": "outside",
        "label-font-size": 12
      }
    },
    {
      "id": "n6",
      "position": {
        "x": 806.4571502073363,
        "y": -91.0000000000019
      },
      "caption": "Route Request",
      "labels": [
        "IIS Logs"
      ],
      "properties": {
        "Component": "HTTP.sys",
        "Process": "w3wp.exe"
      },
      "style": {
        "border-color": "#0062b1",
        "label-position": "outside",
        "label-font-size": 12,
        "property-font-size": 12
      }
    },
    {
      "id": "n7",
      "position": {
        "x": 557.75378056401,
        "y": -91.0000000000019
      },
      "caption": "Send HTTP Request",
      "labels": [],
      "properties": {},
      "style": {
        "border-color": "#68bc00",
        "label-position": "outside",
        "label-font-size": 12
      }
    },
    {
      "id": "n8",
      "position": {
        "x": 1233.9110120599262,
        "y": -381.9317387512681
      },
      "caption": "Create New File",
      "labels": [
        "Method: Tangential",
        "Telemetry: Sysmon 11"
      ],
      "properties": {},
      "style": {
        "border-color": "#0062b1",
        "label-position": "outside",
        "label-font-size": 12
      }
    },
    {
      "id": "n9",
      "position": {
        "x": 1841.5474308993319,
        "y": -91.00000000000199
      },
      "caption": "Call .NET API",
      "labels": [
        "No process spawn",
        "No direct telemetry",
        "Actions may produce telemetry"
      ],
      "properties": {
        "Tangential": "API calls are attacker controlled"
      },
      "style": {
        "border-color": "#0062b1",
        "label-position": "outside",
        "label-font-size": 12,
        "property-font-size": 12
      }
    },
    {
      "id": "n12",
      "position": {
        "x": 1370.124887773176,
        "y": 128.28479174777
      },
      "caption": "Compile ASPX",
      "labels": [
        "File Created: Temp ASP.NET",
        "Telemetry: Sysmon 11",
        "Compiler: csc.exe (may be in-process on newer versions)"
      ],
      "properties": {
        "Child process": "csc.exe (version-dependent)",
        "API": "System.CodeDom.Compiler",
        "Output": "Temporary ASP.NET Files\\<app>\\<hash>\\<hash>.dll"
      },
      "style": {
        "border-color": "#0062b1",
        "label-position": "outside",
        "label-font-size": 12,
        "property-font-size": 12
      }
    },
    {
      "id": "n13",
      "position": {
        "x": 1088.2910189902561,
        "y": -91.00000000000193
      },
      "caption": "Match Handler",
      "labels": [
        "No direct telemetry"
      ],
      "properties": {
        "Handler": "ASP.NET/ASP"
      },
      "style": {
        "caption-color": "#000000",
        "border-color": "#0062b1",
        "property-font-size": 12,
        "label-font-size": 12,
        "label-position": "outside"
      }
    },
    {
      "id": "n14",
      "position": {
        "x": 920.3215013064067,
        "y": -381.9317387512681
      },
      "caption": "Modify Existing File",
      "labels": [
        "Method: Tangential",
        "Telemetry: FIM",
        "Telemetry: Sysmon 2"
      ],
      "properties": {},
      "style": {
        "label-position": "outside",
        "label-font-size": 12,
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n15",
      "position": {
        "x": 1088.2910189902561,
        "y": 128.28479174777
      },
      "caption": "Write Config",
      "labels": [
        "web.config",
        "Telemetry: Sysmon 11",
        "Telemetry: FIM",
        "Telemetry: IIS Config Change"
      ],
      "properties": {},
      "style": {
        "property-font-size": 12,
        "label-font-size": 12,
        "label-position": "outside",
        "border-color": "#0062b1"
      }
    },
    {
      "id": "n16",
      "position": {
        "x": 1973.09361572448,
        "y": -220.03043108807054
      },
      "caption": "Invoke FastCGI",
      "labels": [],
      "properties": {
        "Process": "php-cgi",
        "Parent Process": "w3wp.exe"
      },
      "style": {
        "border-color": "#0062b1",
        "property-font-size": 12
      }
    },
    {
      "id": "n17",
      "position": {
        "x": 2150.13257496049,
        "y": -220.03043108807054
      },
      "caption": "Process Spawn",
      "labels": [
        "Out Of Scope"
      ],
      "properties": {
        "Process": "php-cgi"
      },
      "style": {
        "border-color": "#0062b1",
        "property-font-size": 12,
        "label-font-size": 12,
        "label-position": "outside"
      }
    }
  ],
  "relationships": [
    {
      "id": "n3",
      "fromId": "n0",
      "toId": "n4",
      "type": "",
      "properties": {
        "Process Spawn": "If shell calls OS command"
      },
      "style": {
        "arrow-color": "#000000",
        "property-font-size": 12
      }
    },
    {
      "id": "n8",
      "fromId": "n7",
      "toId": "n6",
      "type": "",
      "properties": {},
      "style": {
        "arrow-color": "#000000"
      }
    },
    {
      "id": "n13",
      "fromId": "n0",
      "toId": "n9",
      "type": "",
      "properties": {
        "Call .NET API": "If in process API"
      },
      "style": {
        "arrow-color": "#000000",
        "property-font-size": 12
      }
    },
    {
      "id": "n17",
      "fromId": "n0",
      "toId": "n12",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n18",
      "fromId": "n13",
      "toId": "n0",
      "type": "",
      "properties": {},
      "style": {
        "arrow-color": "#000000"
      }
    },
    {
      "id": "n19",
      "fromId": "n6",
      "toId": "n13",
      "type": "",
      "properties": {},
      "style": {
        "arrow-color": "#000000"
      }
    },
    {
      "id": "n20",
      "fromId": "n8",
      "toId": "n13",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n21",
      "fromId": "n14",
      "toId": "n13",
      "type": "",
      "properties": {},
      "style": {}
    },
    {
      "id": "n22",
      "fromId": "n15",
      "toId": "n13",
      "type": "",
      "properties": {},
      "style": {
        "arrow-color": "#000000"
      }
    },
    {
      "id": "n23",
      "fromId": "n0",
      "toId": "n16",
      "type": "",
      "properties": {
        "Invoke FastCGI": "If PHP"
      },
      "style": {
        "arrow-color": "#000000",
        "property-font-size": 12
      }
    },
    {
      "id": "n24",
      "fromId": "n16",
      "toId": "n17",
      "type": "",
      "properties": {},
      "style": {}
    }
  ]
}